<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="theme-color" content="#FFB6C1" />
  <meta name="description" content="A once-in-a-lifetime Valentine moment ‚Äî crafted just for you." />

  <meta property="og:title" content="üíï A Moment Just For You üíï" />
  <meta property="og:description" content="A little love letter, just for you." />
  <meta property="og:type" content="website" />

  <title>üíï A Moment Just For You üíï</title>

  <!-- Favicon -->
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üíñ</text></svg>">

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700;800&family=Cormorant+Garamond:wght@300;400;600;700&family=Raleway:wght@300;400;500;600;700&family=Crimson+Text:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">



  <style>
    :root{
      --pink-1:#FFB6C1;
      --pink-2:#FF69B4;
      --pink-3:#FF1493;
      --pink-4:#C71585;
      --ink:#2b2b2b;
      --glass: rgba(255,255,255,0.22);
      --glass-strong: rgba(255,255,255,0.35);

      --shadow: 0 18px 60px rgba(255, 20, 147, 0.18);
      --shadow-soft: 0 10px 36px rgba(255, 105, 180, 0.18);

      --radius-xl: 28px;
      --radius-lg: 22px;

      --safe-top: env(safe-area-inset-top);
      --safe-bottom: env(safe-area-inset-bottom);
    }

    *{ box-sizing:border-box; -webkit-tap-highlight-color: transparent; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family:'Raleway', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      overflow-x:hidden;
      color:var(--ink);
      background: radial-gradient(1200px 800px at 20% 20%, rgba(255,255,255,0.55), rgba(255,255,255,0) 55%),
                  linear-gradient(135deg, #FFF8F2 0%, #FFF0E8 18%, #FFE8E0 36%, #FFE0D8 54%, #FFD6D0 72%, #FFCCC8 90%, #FFC2C0 100%);
      background-attachment: fixed;
      touch-action: pan-y;
    }

    .playfair{ font-family:'Playfair Display', serif; }
    .cormorant{ font-family:'Cormorant Garamond', serif; }
    .crimson{ font-family:'Crimson Text', serif; }

    /* Subtle animated background shift (disabled in reduced motion) */
    @keyframes bgShift{
      0%,100%{ filter:hue-rotate(0deg) saturate(1); }
      50%{ filter:hue-rotate(-8deg) saturate(1.05); }
    }
    .bg-animate{ animation: bgShift 18s ease-in-out infinite; }

    /* Glass */
    .glass{
      background: var(--glass);
      backdrop-filter: blur(18px) saturate(180%);
      -webkit-backdrop-filter: blur(18px) saturate(180%);
      border: 1px solid rgba(255,255,255,0.42);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-soft);
    }
    .glass-strong{
      background: var(--glass-strong);
      backdrop-filter: blur(20px) saturate(185%);
      -webkit-backdrop-filter: blur(20px) saturate(185%);
      border: 1px solid rgba(255,255,255,0.55);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow);
    }

    /* Controls button */
    .pill{
      background: rgba(255,255,255,0.35);
      border: 1px solid rgba(255,255,255,0.55);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 999px;
      padding: 10px 14px;
      box-shadow: 0 10px 30px rgba(255, 105, 180, 0.12);
      user-select:none;
    }

    /* Progress bar (top) */
    .progress{
      position: fixed;
      left: 0;
      top: 0;
      height: 3px;
      width: 0%;
      background: linear-gradient(90deg, var(--pink-1), var(--pink-2), var(--pink-3));
      z-index: 1000;
      transition: width .25s ease;
    }

    /* Loading */
    #loading{
      position: fixed;
      inset: 0;
      z-index: 3000;
      display:flex;
      align-items:center;
      justify-content:center;
      background: linear-gradient(135deg, #FFE5EC 0%, #FFC2D4 35%, #FF8FAB 70%, #FFB6C1 100%);
    }
    #loading .card{
      width: min(520px, 92vw);
      padding: 34px 26px;
      text-align:center;
      border-radius: 30px;
      background: rgba(255,255,255,0.18);
      border: 2px solid rgba(255,255,255,0.35);
      backdrop-filter: blur(28px) saturate(200%);
      -webkit-backdrop-filter: blur(28px) saturate(200%);
      box-shadow: 0 20px 70px rgba(255, 20, 147, 0.18);
    }
    @keyframes heartbeat {
      0%,100%{ transform: scale(1); }
      50%{ transform: scale(1.14); }
    }
    .beat{ animation: heartbeat 2.4s ease-in-out infinite; filter: drop-shadow(0 0 25px rgba(255,255,255,0.55)); }

    /* Start overlay (tap to begin) */
    #startOverlay{
      position: fixed;
      inset: 0;
      z-index: 2500;
      display:none;
      align-items:center;
      justify-content:center;
      padding: 16px;
      background: rgba(255, 182, 193, 0.22);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    #startOverlay .card{
      width: min(560px, 94vw);
      padding: 22px 18px;
      border-radius: 28px;
      text-align:center;
    }
    .primary{
      background: linear-gradient(135deg, var(--pink-1), var(--pink-2), var(--pink-3));
      color:white;
      box-shadow: 0 14px 50px rgba(255, 20, 147, 0.28);
      border: 1px solid rgba(255,255,255,0.35);
      transition: transform .25s ease, box-shadow .25s ease, filter .25s ease;
    }
    .primary:hover{ transform: translateY(-2px) scale(1.02); filter: brightness(1.03); }
    .primary:active{ transform: translateY(0) scale(.99); }

    .secondary{
      background: linear-gradient(135deg, #f3f3f3, #d8d8d8);
      color: #3a3a3a;
      border: 1px solid rgba(255,255,255,0.55);
      box-shadow: 0 12px 40px rgba(0,0,0,0.08);
      transition: transform .25s ease, box-shadow .25s ease, filter .25s ease;
    }
    .secondary:hover{ transform: translateY(-2px) scale(1.01); filter: brightness(1.02); }
    .secondary:active{ transform: translateY(0) scale(.99); }

    /* Background layers */
    #bgLayers{ position: fixed; inset: 0; z-index: 0; overflow:hidden; pointer-events:none; }
    .floating-heart, .sparkle, .petal, .heart-rain {
      position:absolute;
      pointer-events:none;
      will-change: transform, opacity;
    }

    @keyframes floatUp{
      0%{ transform: translateY(110vh) rotate(0deg) scale(.6); opacity:0; }
      12%{ opacity:.65; }
      88%{ opacity:.65; }
      100%{ transform: translateY(-20vh) rotate(360deg) scale(.6); opacity:0; }
    }
    .floating-heart{ animation: floatUp 12s linear infinite; }

    @keyframes twinkle{
      0%,100%{ opacity:0; transform: scale(0) rotate(0deg); }
      50%{ opacity:.85; transform: scale(1.6) rotate(180deg); }
    }
    .sparkle{
      width: 3px; height: 3px;
      background: radial-gradient(circle, #FFFFFF 0%, rgba(255, 214, 224, 0.9) 55%, transparent 100%);
      border-radius: 999px;
      box-shadow: 0 0 12px rgba(255,255,255,.85);
      animation: twinkle 3.8s ease-in-out infinite;
    }

    @keyframes fall{
      0%{ transform: translateY(-15vh) rotate(0deg) translateX(0); opacity:0; }
      10%{ opacity:.7; }
      90%{ opacity:.7; }
      100%{ transform: translateY(115vh) rotate(720deg) translateX(90px); opacity:0; }
    }
    .petal{
      width: 12px; height: 12px;
      background: linear-gradient(135deg, #FFB6C1 0%, #FFC2D4 55%, #FFD6E0 100%);
      border-radius: 50% 0 50% 0;
      filter: blur(.4px);
      animation: fall 14s linear infinite;
    }

    @keyframes rain{
      0%{ transform: translateY(-12vh) rotate(0deg) scale(0); opacity:0; }
      12%{ opacity:.9; transform: translateY(0vh) rotate(32deg) scale(1); }
      90%{ opacity:.9; }
      100%{ transform: translateY(112vh) rotate(180deg) scale(.85); opacity:0; }
    }
    .heart-rain{ animation: rain linear infinite; z-index:1; }

    /* Layout */
    #app{
      position: relative;
      min-height: 100vh;
      z-index: 1;
      padding: calc(16px + var(--safe-top)) 16px calc(18px + var(--safe-bottom));
      display:flex;
      flex-direction:column;
      gap: 14px;
    }

    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding-top: 4px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap: 10px;
    }
    .brand .mark{
      width: 42px; height: 42px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      background: rgba(255,255,255,0.35);
      border: 1px solid rgba(255,255,255,0.6);
      box-shadow: 0 10px 30px rgba(255, 105, 180, 0.14);
      font-size: 22px;
    }

    .controls{
      display:flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content:flex-end;
    }

    main{
      flex:1;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* Step card */
    .stage{
      width: min(860px, 100%);
    }
    .step{
      display:none;
      padding: 22px;
    }
    .step.active{ display:block; }

    .stepTitle{
      font-size: clamp(28px, 6vw, 54px);
      line-height: 1.08;
      letter-spacing: .2px;
      color: var(--pink-3);
      text-shadow: 0 2px 24px rgba(255, 105, 180, 0.22);
    }

    .sub{
      color: var(--pink-4);
      opacity: .92;
    }

    /* Progress dots */
    .dots{
      display:flex;
      justify-content:center;
      gap: 10px;
      margin-top: 10px;
    }
    .dot{
      width: 10px; height: 10px;
      border-radius: 999px;
      background: rgba(255,255,255,0.6);
      border: 1px solid rgba(255,255,255,0.7);
      box-shadow: 0 8px 18px rgba(255, 105, 180, 0.16);
      transition: transform .2s ease, background .2s ease;
    }
    .dot.active{
      background: linear-gradient(135deg, var(--pink-1), var(--pink-3));
      transform: scale(1.25);
    }

    /* Photo */
    .photo{
      width: 100%;
      max-height: 320px;
      object-fit: cover;
      border-radius: 20px;
      box-shadow: 0 18px 60px rgba(0,0,0,0.14);
      border: 1px solid rgba(255,255,255,0.65);
      background: rgba(255,255,255,0.35);
    }

    /* Custom modal alert */
    #modalOverlay{
      position: fixed;
      inset: 0;
      z-index: 4000;
      display:none;
      background: rgba(255, 182, 193, 0.28);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      align-items:center;
      justify-content:center;
      padding: 16px;
    }
    #modal{
      width: min(520px, 94vw);
      transform: scale(.96);
      opacity:0;
      transition: transform .25s ease, opacity .25s ease;
    }
    #modalOverlay.show #modal{
      transform: scale(1);
      opacity: 1;
    }

    /* Celebration overlay */
    #celebration{
      position: fixed;
      inset: 0;
      z-index: 2200;
      display:none;
      align-items:center;
      justify-content:center;
      padding: 18px;
      background: radial-gradient(1100px 700px at 30% 20%, rgba(255,255,255,0.7), rgba(255,255,255,0) 55%),
                  linear-gradient(135deg, #FFE4E9 0%, #FFC2D4 45%, #FFB6C1 100%);
    }

    /* Confetti/fireworks particles (DOM-based) */
    .firework{
      position:absolute;
      width: 3px;
      height: 3px;
      border-radius: 999px;
      animation: explode 1.8s ease-out forwards;
      box-shadow: 0 0 6px currentColor;
      will-change: transform, opacity;
    }
    @keyframes explode{
      0%{ transform: translate(0,0) scale(1); opacity: 1; }
      100%{ transform: translate(var(--tx), var(--ty)) scale(.25); opacity: 0; }
    }
    .confetti{
      position:absolute;
      animation: confettiFall 4.8s ease-in-out infinite;
      will-change: transform, opacity;
      filter: drop-shadow(0 0 3px rgba(255,182,193,0.55));
    }
    @keyframes confettiFall{
      0%{ transform: translateY(-10vh) rotate(0deg) scale(1); opacity:0; }
      10%{ opacity:1; }
      90%{ opacity:1; }
      100%{ transform: translateY(110vh) rotate(1080deg) scale(.5); opacity:0; }
    }

    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce){
      .bg-animate{ animation:none !important; }
      .beat{ animation:none !important; }
      .floating-heart, .sparkle, .petal, .heart-rain{ animation:none !important; }
      .primary, .secondary{ transition:none !important; }
    }
    html[data-motion="reduced"] .bg-animate{ animation:none !important; }
    html[data-motion="reduced"] .floating-heart,
    html[data-motion="reduced"] .sparkle,
    html[data-motion="reduced"] .petal,
    html[data-motion="reduced"] .heart-rain{ animation:none !important; }
    html[data-motion="reduced"] .firework,
    html[data-motion="reduced"] .confetti{ display:none !important; }

    /* Make it feel great on mobile: bigger tap targets */
    button{ -webkit-tap-highlight-color: transparent; }
    .tap{
      min-height: 52px;
      padding: 14px 18px;
      border-radius: 999px;
      font-weight: 700;
      letter-spacing: 0.5px;
      transition: transform .35s cubic-bezier(.34,1.56,.64,1);
    }

    /* Button size enhancing pulse when Yes grows */
    @keyframes btnPulse{
      0%{ transform: scale(1); }
      50%{ transform: scale(1.12); }
      100%{ transform: scale(1); }
    }
    .btn-pulse{
      animation: btnPulse .4s ease;
    }

    /* Heart cursor trail (desktop only) */
    .heart-cursor{
      position: fixed;
      pointer-events:none;
      z-index: 1800;
      font-size: 14px;
      animation: cursorFloat 1s ease-out forwards;
      will-change: transform, opacity;
    }
    @keyframes cursorFloat{
      0%{ opacity:1; transform: translateY(0) scale(1); }
      100%{ opacity:0; transform: translateY(-50px) scale(.55); }
    }

    /* Small helper text */
    .muted{ opacity: .78; }

    /* A tiny ‚Äúshine‚Äù accent */
    .shine{
      position: relative;
      overflow: hidden;
    }
    .shine::after{
      content:"";
      position:absolute;
      inset:-40%;
      background: linear-gradient(120deg, transparent 0%, rgba(255,255,255,0.35) 45%, transparent 65%);
      transform: translateX(-60%) rotate(10deg);
      animation: shine 5.2s ease-in-out infinite;
      pointer-events:none;
    }
    @keyframes shine{
      0%, 55%{ transform: translateX(-70%) rotate(10deg); opacity:0; }
      60%{ opacity: 1; }
      100%{ transform: translateX(70%) rotate(10deg); opacity:0; }
    }
    html[data-motion="reduced"] .shine::after{ animation:none !important; opacity:0 !important; }

    /* iOS rubber-band safe */
    .no-select{ user-select:none; -webkit-user-select:none; }

    /* Love letter aesthetic */
    .letter-bg{
      background: linear-gradient(170deg, #FFF8F0 0%, #FFF0E6 30%, #FFE8E0 60%, #FFE0D8 100%);
      border: 1px solid rgba(200, 160, 130, 0.25);
      box-shadow: 0 8px 40px rgba(180, 120, 90, 0.10), inset 0 0 80px rgba(255,240,230,0.5);
    }
    .tenor-gif{
      border-radius: 16px;
      max-width: 180px;
      height: auto;
      margin: 0 auto;
      display: block;
      filter: drop-shadow(0 4px 12px rgba(255,105,180,0.18));
    }
    .tenor-gif-sm{
      max-width: 120px;
    }
    .wax-seal{
      font-size: 48px;
      filter: drop-shadow(0 3px 10px rgba(180,60,60,0.2));
    }
  </style>
</head>
<body class="no-select">

  <div class="progress" id="progressBar" aria-hidden="true"></div>

  <!-- Loading -->
  <div id="loading" class="bg-animate">
    <div class="card">
      <img src="https://media.tenor.com/odyVsZbC-OYAAAAM/heart.gif" alt="Animated heart" class="tenor-gif beat" style="max-width:100px;" onerror="this.style.display='none';document.getElementById('loadingHeartFallback').style.display='block';">
      <div id="loadingHeartFallback" class="text-7xl beat" style="display:none;">üíñ</div>
      <div class="mt-6 text-white/95 tracking-[.28em] uppercase text-sm sm:text-base font-light">Preparing something special‚Ä¶</div>
      <div class="mt-6">
        <div class="h-2 rounded-full bg-white/25 overflow-hidden">
          <div id="loadingFill" class="h-2 rounded-full" style="width:0%; background:linear-gradient(90deg, rgba(255,255,255,0.85), rgba(255,255,255,0.45));"></div>
        </div>
        <div id="loadingPct" class="mt-3 text-white/95 text-sm tracking-widest">0%</div>
      </div>
    </div>
  </div>

  <!-- Tap to begin overlay -->
  <div id="startOverlay">
    <div class="card glass-strong">
      <img src="https://media.tenor.com/SNL9_xhZl9oAAAAi/love-letter.gif" alt="Love letter" class="tenor-gif" style="max-width:80px;" onerror="this.outerHTML='<div class=\'text-5xl\'>üíå</div>';">
      <h2 class="mt-4 playfair text-3xl sm:text-4xl font-extrabold" style="color: var(--pink-3);">
        A Letter For You
      </h2>
      <p class="mt-3 text-base sm:text-lg muted">
        Tap <span class="font-semibold">Begin</span> when you‚Äôre ready.
        <span class="block mt-1">Music is optional üéµ</span>
      </p>

      <div class="mt-6 flex flex-col sm:flex-row gap-3 justify-center">
        <button id="beginBtn" class="tap primary shine">Begin ‚ú®</button>
        <button id="muteBtn" class="tap secondary" aria-label="Begin with music off">Begin (Silent) ü§´</button>
      </div>

      <p class="mt-5 text-xs muted">
        Turn your volume up for the full experience.
      </p>
    </div>
  </div>

  <!-- Background layers -->
  <div id="bgLayers" aria-hidden="true"></div>

  <!-- App -->
  <div id="app" class="hidden">
    <header>
      <div class="brand">
        <div class="mark" aria-hidden="true">üíû</div>
        <div class="leading-tight">
          <div id="toLine" class="text-sm sm:text-base font-semibold" style="color: var(--pink-4);">To my favorite person</div>
          <div id="dateLine" class="text-xs sm:text-sm muted"></div>
        </div>
      </div>

      <div class="controls">
        <button id="musicToggle" class="pill text-sm font-semibold" type="button" aria-label="Toggle music">
          üîá Music
        </button>
        <button id="motionToggle" class="pill text-sm font-semibold" type="button" aria-label="Toggle calm mode">
          ü´ß Calm
        </button>
      </div>
    </header>

    <main>
      <div class="stage">
        <div class="glass-strong">
          <!-- Steps -->
          <section id="step1" class="step active">
            <img src="https://media.tenor.com/fco-_GCUbEAAAAAM/hearts.gif" alt="Floating hearts" class="tenor-gif tenor-gif-sm mb-4" onerror="this.style.display='none';">
            <h1 class="stepTitle playfair font-extrabold text-center">
              A little journey, just for you üíå
            </h1>
            <p class="mt-4 text-center text-lg sm:text-xl cormorant sub italic">
              <span id="quoteText">‚ÄúYou are my today and all of my tomorrows.‚Äù</span>
            </p>

            <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center">
              <button id="s1Yes" class="tap primary">Let‚Äôs go üíñ</button>
              <button id="s1No"  class="tap secondary">Not yet‚Ä¶</button>
            </div>

            <div class="dots" aria-label="Progress">
              <div class="dot active" id="dot1"></div>
              <div class="dot" id="dot2"></div>
              <div class="dot" id="dot3"></div>
            </div>
          </section>

          <section id="step2" class="step">
            <img src="https://media.tenor.com/gHfFPJnrVNoAAAAM/love-you-heart.gif" alt="Love heart" class="tenor-gif tenor-gif-sm mb-4" onerror="this.style.display='none';">
            <h2 class="stepTitle playfair font-extrabold text-center">
              One tiny promise
            </h2>
            <p class="mt-5 text-center text-xl sm:text-2xl cormorant sub">
              Will you choose us, every single day?
            </p>

            <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center">
              <button id="s2Yes" class="tap primary">Always ‚ù§Ô∏è</button>
              <button id="s2No"  class="tap secondary">Hmm‚Ä¶ maybe</button>
            </div>

            <div class="dots">
              <div class="dot" id="dot1b"></div>
              <div class="dot active" id="dot2b"></div>
              <div class="dot" id="dot3b"></div>
            </div>
          </section>

          <section id="step3" class="step">
            <h2 class="stepTitle playfair font-extrabold text-center">
              Here goes everything‚Ä¶
            </h2>

            <div class="mt-6 text-center text-lg sm:text-xl md:text-2xl cormorant sub leading-relaxed">
              <p>
                <span id="herNameInline" class="font-semibold" style="color: var(--pink-3);">My Love</span>,<br>
                you are my calm in the chaos,<br class="hidden sm:block">
                my warmth on cold days,<br class="hidden sm:block">
                and the reason I smile for no reason at all.
              </p>
              <p class="mt-5 playfair font-bold text-2xl sm:text-3xl md:text-4xl" style="color: var(--pink-3);">
                Will you be my Valentine? üíï
              </p>
            </div>

            <div class="mt-4 flex justify-center">
              <img src="https://media.tenor.com/mIxXyfdsrqMAAAAM/cute-i-love-you.gif" alt="Cute love" class="tenor-gif" style="max-width:150px;" onerror="this.style.display='none';">
            </div>

            <div class="mt-7">
              <img id="photo" class="photo hidden" alt="A special photo" />
            </div>

            <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center items-center">
              <button id="finalYes" class="tap primary text-xl sm:text-2xl">YES, forever! üíû</button>
              <button id="finalNo" class="tap secondary text-xl sm:text-2xl">Not yet</button>
            </div>

            <div class="dots">
              <div class="dot" id="dot1c"></div>
              <div class="dot" id="dot2c"></div>
              <div class="dot active" id="dot3c"></div>
            </div>


          </section>
        </div>

        <div class="mt-4 text-center text-xs muted">
          Written with love ¬∑ <span id="fromLine">from someone who adores you</span>
        </div>
      </div>
    </main>
  </div>

  <!-- Celebration overlay -->
  <div id="celebration">
    <div id="fxFireworks" class="fixed inset-0 pointer-events-none"></div>
    <div id="fxConfetti" class="fixed inset-0 pointer-events-none"></div>
    <div id="fxHeartRain" class="fixed inset-0 pointer-events-none"></div>

    <div class="glass-strong w-full max-w-4xl p-7 sm:p-10 text-center relative">
      <img src="https://media.tenor.com/RJXM99kdbRIAAAAM/cute-hearts.gif" alt="Celebration hearts" class="tenor-gif beat" style="max-width:120px;" onerror="this.outerHTML='<div class=\'text-6xl sm:text-7xl beat\' aria-hidden=\'true\'>üíñ</div>';">
      <h1 class="mt-4 playfair text-4xl sm:text-6xl md:text-7xl font-black" style="color: var(--pink-3); text-shadow: 0 2px 26px rgba(255,105,180,0.25);">
        You said yes! üíû
      </h1>

      <p class="mt-6 text-xl sm:text-2xl md:text-3xl cormorant leading-relaxed" style="color: var(--pink-4);">
        <span class="font-semibold">My love</span>, you‚Äôve just made me the happiest person alive.  
        <span class="block mt-2">I promise to cherish every moment with you ‚Äî today, tomorrow, and always.</span>
      </p>

      <p class="mt-7 playfair text-2xl sm:text-3xl md:text-4xl font-bold" style="color: var(--pink-3);">
        Happy Valentine‚Äôs Day, <span id="herNameCelebration">my everything</span>. üåπ
      </p>

      <p class="mt-8 text-xs muted">
        Take a screenshot to keep this moment forever.
      </p>
    </div>
  </div>

  <!-- Modal (for playful "No" prompts) -->
  <div id="modalOverlay">
    <div id="modal" class="glass-strong p-6 text-center">
      <div class="text-6xl" aria-hidden="true">üíî</div>
      <p id="modalText" class="mt-4 text-xl sm:text-2xl cormorant font-semibold" style="color: var(--pink-3);"></p>
      <div class="mt-6">
        <button id="modalOk" class="tap primary">Okay üíï</button>
      </div>
    </div>
  </div>

  <!-- Audio (optional). Replace src with your own hosted romantic instrumental if desired. -->
  <audio id="bgMusic" loop preload="auto">
    <source src="https://assets.codepen.io/831041/valentine-romantic-piano.mp3" type="audio/mpeg" />
  </audio>

  <noscript>
    <div style="padding:16px; background:#fff; color:#000;">
      This page needs JavaScript to run the Valentine experience. üíñ
    </div>
  </noscript>

  <script>
    // ==========================================================
    // MASTERPIECE VALENTINE EXPERIENCE
    // - Combines: cinematic loading + rich effects + quotes rotation
    //   with: multi-step journey + photo + share.
    // ==========================================================

    // ---------- Personalization (edit these OR use URL params) ----------
    // URL params:
    //   ?to=HerName&from=YourName&photo=https://...jpg
    //   (to keep it safe, text is set via textContent, not innerHTML)
    const DEFAULTS = {
      to: "My Love",
      from: "someone who adores you",
      photo: "", // optional URL
    };

    // ---------- Quotes (rotates in Step 1) ----------
    const QUOTES = [
      "You are my today and all of my tomorrows.",
      "Every love story is beautiful ‚Äî but ours is my favorite.",
      "My heart is perfect because you are inside.",
      "Forever sounds pretty good with you.",
      "You make my heart smile in ways I can‚Äôt explain."
    ];

    // ---------- Playful ‚ÄúNo‚Äù messages ----------
    const NO_MESSAGES = [
      "Are you sure? ü•∫",
      "Pretty please? üíï",
      "One more chance? üåπ",
      "I‚Äôll wait for you üíñ"
    ];

    // Button size animation constants
    const YES_GROW_INCREMENT = 0.12;
    const YES_MAX_SCALE      = 1.8;
    const NO_SHRINK_DECREMENT = 0.08;
    const NO_MIN_SCALE        = 0.5;

    // ---------- State ----------
    const STATE_KEY = "val_master_state_v1";
    const state = {
      step: 1,
      yes: false,
      noCount: 0,
      musicOn: false,
      ...loadStateSafe()
    };

    // ---------- Elements ----------
    const htmlEl        = document.documentElement;
    const progressBar   = document.getElementById("progressBar");

    const loading       = document.getElementById("loading");
    const loadingFill   = document.getElementById("loadingFill");
    const loadingPct    = document.getElementById("loadingPct");

    const startOverlay  = document.getElementById("startOverlay");
    const beginBtn      = document.getElementById("beginBtn");
    const muteBtn       = document.getElementById("muteBtn");

    const app           = document.getElementById("app");
    const bgLayers      = document.getElementById("bgLayers");

    const toLine        = document.getElementById("toLine");
    const fromLine      = document.getElementById("fromLine");
    const dateLine      = document.getElementById("dateLine");

    const quoteText     = document.getElementById("quoteText");

    const step1         = document.getElementById("step1");
    const step2         = document.getElementById("step2");
    const step3         = document.getElementById("step3");

    const s1Yes         = document.getElementById("s1Yes");
    const s1No          = document.getElementById("s1No");
    const s2Yes         = document.getElementById("s2Yes");
    const s2No          = document.getElementById("s2No");
    const finalYes      = document.getElementById("finalYes");
    const finalNo       = document.getElementById("finalNo");

    const herNameInline = document.getElementById("herNameInline");
    const photoEl       = document.getElementById("photo");

    const celebration   = document.getElementById("celebration");
    const herNameCelebr = document.getElementById("herNameCelebration");


    const fxFireworks   = document.getElementById("fxFireworks");
    const fxConfetti    = document.getElementById("fxConfetti");
    const fxHeartRain   = document.getElementById("fxHeartRain");

    const modalOverlay  = document.getElementById("modalOverlay");
    const modalText     = document.getElementById("modalText");
    const modalOk       = document.getElementById("modalOk");

    const musicToggle   = document.getElementById("musicToggle");
    const motionToggle  = document.getElementById("motionToggle");
    const music         = document.getElementById("bgMusic");

    // ---------- Helpers ----------
    function loadStateSafe(){
      try{
        const raw = localStorage.getItem(STATE_KEY);
        return raw ? JSON.parse(raw) : {};
      }catch(e){ return {}; }
    }
    function saveStateSafe(){
      try{ localStorage.setItem(STATE_KEY, JSON.stringify(state)); }catch(e){}
    }
    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }
    function vibrate(ms=30){
      try{ if ("vibrate" in navigator) navigator.vibrate(ms); }catch(e){}
    }

    // Sanitize URL params by setting only via textContent.
    function getConfig(){
      const params = new URLSearchParams(window.location.search);
      const to   = (params.get("to")   || params.get("name") || DEFAULTS.to).slice(0, 40);
      const from = (params.get("from") || DEFAULTS.from).slice(0, 40);

      // Photo: allow only http(s) to avoid "javascript:" injection.
      const rawPhoto = params.get("photo") || DEFAULTS.photo;
      const photo = (/^https?:\/\//i.test(rawPhoto) || rawPhoto.startsWith("./") || rawPhoto.startsWith("../")) ? rawPhoto : "";

      return { to, from, photo };
    }

    const CONFIG = getConfig();

    // ---------- Loading sequence ----------
    function runLoader(){
      let pct = 0;
      const tick = setInterval(() => {
        pct += Math.random() * 16;
        pct = clamp(pct, 0, 100);
        loadingFill.style.width = Math.floor(pct) + "%";
        loadingPct.textContent = Math.floor(pct) + "%";
        if (pct >= 100){
          clearInterval(tick);
          setTimeout(() => {
            loading.style.opacity = "0";
            loading.style.transition = "opacity 1.1s ease";
            setTimeout(() => {
              loading.style.display = "none";
              startOverlay.style.display = "flex";
            }, 1100);
          }, 500);
        }
      }, 140);
    }

    // ---------- Date line ----------
    function setDateLine(){
      const now = new Date();
      const opts = { weekday: "long", year: "numeric", month: "long", day: "numeric" };
      const nice = now.toLocaleDateString(undefined, opts);
      // Valentine's day check (Feb 14)
      if (now.getMonth() === 1 && now.getDate() === 14) {
        dateLine.textContent = "üåπ Happy Valentine‚Äôs Day üåπ";
      } else {
        dateLine.textContent = "This special moment ‚Ä¢ " + nice;
      }
    }

    // ---------- Motion setting ----------
    function syncMotion(){
      // Default: follow OS preference unless state explicitly set
      const prefersReduced = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      if (typeof state.reducedMotion !== "boolean") state.reducedMotion = prefersReduced;
      htmlEl.dataset.motion = state.reducedMotion ? "reduced" : "full";
      motionToggle.textContent = state.reducedMotion ? "ü´ß Calm on" : "ü´ß Calm";
      saveStateSafe();
    }

    motionToggle.addEventListener("click", () => {
      state.reducedMotion = !state.reducedMotion;
      syncMotion();
      initBackground();

      // If celebration is showing, update effects to match the new motion setting.
      if (celebration.style.display === "flex") {
        clearCelebrationFx();
        if (!state.reducedMotion) {
          startFireworks();
          startConfetti();
          startCelebrationHeartRain();
        }
      }
    });

    // ---------- Music control (safe for mobile gesture rules) ----------
    // We'll try <audio> first (piano), and if it fails, fallback to a simple WebAudio melody.
    let audioCtx = null;
    let melodyTimer = null;

    function stopWebAudio(){
      if (melodyTimer) { clearTimeout(melodyTimer); melodyTimer = null; }
      if (audioCtx){
        try{ audioCtx.close(); }catch(e){}
        audioCtx = null;
      }
    }

    function playWebAudioLoop(){
      stopWebAudio();
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      const master = audioCtx.createGain();
      master.gain.value = 0.08;
      master.connect(audioCtx.destination);

      const notes = [
        {f:523.25, d:0.45}, {f:587.33, d:0.45}, {f:659.25, d:0.45},
        {f:698.46, d:0.45}, {f:783.99, d:0.95}, {f:659.25, d:0.45},
        {f:523.25, d:0.95},
      ];

      const startAt = audioCtx.currentTime + 0.02;
      let t = startAt;

      notes.forEach(n => {
        const osc = audioCtx.createOscillator();
        osc.type = "sine";
        osc.frequency.value = n.f;

        const g = audioCtx.createGain();
        g.gain.setValueAtTime(0, t);
        g.gain.linearRampToValueAtTime(0.06, t + 0.02);
        g.gain.linearRampToValueAtTime(0, t + n.d);

        osc.connect(g);
        g.connect(master);
        osc.start(t);
        osc.stop(t + n.d);

        t += n.d;
      });

      const loopMs = (t - audioCtx.currentTime) * 1000 + 380;
      melodyTimer = setTimeout(() => {
        if (state.musicOn) playWebAudioLoop();
      }, loopMs);
    }

    async function setMusic(on){
      state.musicOn = on;
      saveStateSafe();

      if (!on){
        musicToggle.textContent = "üîá Music";
        try{ music.pause(); }catch(e){}
        stopWebAudio();
        return;
      }

      musicToggle.textContent = "üîä Music";
      // ensure we never overlap audio sources
      stopWebAudio();
      music.volume = 0.25;

      try{
        await music.play();
      }catch(e){
        // fallback
        playWebAudioLoop();
      }
    }

    musicToggle.addEventListener("click", () => {
      setMusic(!state.musicOn);
    });

    // ---------- Quotes rotation ----------
    let quoteTimer = null;
    function startQuotes(){
      if (quoteTimer) clearInterval(quoteTimer);
      let i = Math.floor(Math.random() * QUOTES.length);
      quoteText.textContent = '"' + QUOTES[i] + '"';
      quoteTimer = setInterval(() => {
        if (state.step !== 1) return;
        i = (i + 1) % QUOTES.length;
        quoteText.style.opacity = "0";
        quoteText.style.transform = "translateY(8px) scale(.985)";
        setTimeout(() => {
          quoteText.textContent = '"' + QUOTES[i] + '"';
          quoteText.style.opacity = "1";
          quoteText.style.transform = "translateY(0) scale(1)";
        }, 260);
      }, 7200);
    }

    // ---------- Background generation ----------
    const bgIntervals = [];
    function clearBackground(){
      bgIntervals.forEach(id => clearInterval(id));
      bgIntervals.length = 0;
      bgLayers.innerHTML = "";
    }

    function addSparkles(count){
      for (let i=0;i<count;i++){
        const s = document.createElement("div");
        s.className = "sparkle";
        s.style.left = Math.random()*100 + "%";
        s.style.top  = Math.random()*100 + "%";
        s.style.animationDelay = (Math.random()*2.5) + "s";
        s.style.animationDuration = (Math.random()*1.6 + 2.4) + "s";
        bgLayers.appendChild(s);
      }
    }

    function addPetals(count){
      for (let i=0;i<count;i++){
        const p = document.createElement("div");
        p.className = "petal";
        p.style.left = Math.random()*100 + "%";
        p.style.animationDelay = (Math.random()*8) + "s";
        p.style.animationDuration = (Math.random()*4 + 10) + "s";
        bgLayers.appendChild(p);
      }
    }

    function addFloatingHearts(count){
      const hearts = ["‚ù§Ô∏è","üíï","üíñ","üíó","üíò","üíù","üíû","üíì"];
      for (let i=0;i<count;i++){
        const h = document.createElement("div");
        h.className = "floating-heart";
        h.textContent = hearts[Math.floor(Math.random()*hearts.length)];
        h.style.left = Math.random()*100 + "%";
        h.style.fontSize = (Math.random()*18 + 14) + "px";
        h.style.animationDuration = (Math.random()*6 + 10) + "s";
        h.style.animationDelay = (Math.random()*4) + "s";
        h.style.opacity = (Math.random()*0.35 + 0.25);
        bgLayers.appendChild(h);
      }
    }

    function addHeartRain(){
      const hearts = ["‚ù§Ô∏è","üíï","üíñ","üíó","üíò","üíù","üíû","üíì","‚ù£Ô∏è","üíü"];
      const makeOne = () => {
        const h = document.createElement("div");
        h.className = "heart-rain";
        h.textContent = hearts[Math.floor(Math.random()*hearts.length)];
        h.style.left = Math.random()*100 + "%";
        h.style.fontSize = (Math.random()*16 + 16) + "px";
        h.style.animationDuration = (Math.random()*2.5 + 3.2) + "s";
        h.style.opacity = (Math.random()*0.35 + 0.55);
        bgLayers.appendChild(h);
        setTimeout(() => h.remove(), 7000);
      };
      // fewer on mobile / calmer mode
      const interval = state.reducedMotion ? 1200 : (window.innerWidth < 520 ? 520 : 420);
      bgIntervals.push(setInterval(makeOne, interval));
      for(let i=0;i<8;i++) setTimeout(makeOne, i*220);
    }

    function initBackground(){
      clearBackground();
      if (state.reducedMotion){
        // Still a little magic, but calm.
        addSparkles(14);
        addFloatingHearts(8);
        return;
      }
      const mobile = window.innerWidth < 520;
      addSparkles(mobile ? 20 : 28);
      addPetals(mobile ? 10 : 16);
      addFloatingHearts(mobile ? 10 : 16);
      addHeartRain();
    }

    // ---------- Cursor/touch heart trail ----------
    let trailEnabled = true;
    function spawnTrail(x,y){
      if (state.reducedMotion) return;
      const h = document.createElement("div");
      h.className = "heart-cursor";
      h.textContent = ["‚ù§Ô∏è","üíï","üíñ","üíó"][Math.floor(Math.random()*4)];
      h.style.left = x + "px";
      h.style.top  = y + "px";
      document.body.appendChild(h);
      setTimeout(() => h.remove(), 1000);
    }

    document.addEventListener("mousemove", (e) => {
      if (!trailEnabled) return;
      if (Math.random() < 0.25) spawnTrail(e.clientX, e.clientY);
    }, {passive:true});

    document.addEventListener("touchmove", (e) => {
      if (!trailEnabled) return;
      if (Math.random() < 0.16) {
        const t = e.touches && e.touches[0];
        if (t) spawnTrail(t.clientX, t.clientY);
      }
    }, {passive:true});

    // ---------- Step navigation ----------
    function setProgress(){
      // 1..3
      const p = (state.step - 1) / 2 * 100;
      progressBar.style.width = p + "%";
    }

    function showStep(n){
      state.step = clamp(n,1,3);
      saveStateSafe();

      step1.classList.toggle("active", state.step === 1);
      step2.classList.toggle("active", state.step === 2);
      step3.classList.toggle("active", state.step === 3);

      // dots (duplicated for each step section, so just set via step logic)
      document.querySelectorAll(".dot").forEach(d => d.classList.remove("active"));
      if (state.step === 1) document.getElementById("dot1").classList.add("active");
      if (state.step === 2) document.getElementById("dot2b").classList.add("active");
      if (state.step === 3) document.getElementById("dot3c").classList.add("active");

      setProgress();
    }

    // ---------- Modal ----------
    function showModal(msg){
      modalText.textContent = msg;
      modalOverlay.style.display = "flex";
      requestAnimationFrame(() => modalOverlay.classList.add("show"));
    }
    function closeModal(){
      modalOverlay.classList.remove("show");
      setTimeout(() => { modalOverlay.style.display = "none"; }, 180);
    }
    modalOk.addEventListener("click", () => { closeModal(); });
    modalOverlay.addEventListener("click", (e) => {
      if (e.target === modalOverlay) closeModal();
    });

    // ---------- Celebration FX ----------
    const fxIntervals = [];
    function clearCelebrationFx(){
      fxIntervals.forEach(id => clearInterval(id));
      fxIntervals.length = 0;
      fxFireworks.innerHTML = "";
      fxConfetti.innerHTML = "";
      fxHeartRain.innerHTML = "";
    }

    function startConfetti(){
      const shapes = ["‚ù§Ô∏è","üíï","üíñ","üíó","üíò","üíù","üåπ","‚ú®","üíê"];
      const spawn = () => {
        const c = document.createElement("div");
        c.className = "confetti";
        c.textContent = shapes[Math.floor(Math.random()*shapes.length)];
        c.style.left = Math.random()*100 + "%";
        c.style.fontSize = (Math.random()*14 + 16) + "px";
        c.style.animationDuration = (Math.random()*2 + 3.8) + "s";
        c.style.animationDelay = (Math.random()*0.8) + "s";
        fxConfetti.appendChild(c);
        setTimeout(() => c.remove(), 6000);
      };
      fxIntervals.push(setInterval(spawn, window.innerWidth < 520 ? 420 : 320));
    }

    function startFireworks(){
      const colors = ["#FFB6C1","#FFC0CB","#FFD6E0","#FFA6C9","#FF69B4","#FF1493","#FFFFFF"];
      const boom = () => {
        const x = Math.random()*window.innerWidth;
        const y = Math.random()*(window.innerHeight*0.45) + 70;
        const particles = window.innerWidth < 520 ? 18 : 24;
        for (let i=0;i<particles;i++){
          const f = document.createElement("div");
          f.className = "firework";
          f.style.left = x + "px";
          f.style.top  = y + "px";
          f.style.background = colors[Math.floor(Math.random()*colors.length)];
          const angle = (Math.PI*2*i)/particles;
          const v = 38 + Math.random()*68;
          f.style.setProperty("--tx", (Math.cos(angle)*v) + "px");
          f.style.setProperty("--ty", (Math.sin(angle)*v) + "px");
          fxFireworks.appendChild(f);
          setTimeout(() => f.remove(), 1900);
        }
      };
      fxIntervals.push(setInterval(boom, 1200));
    }

    function startCelebrationHeartRain(){
      const hearts = ["‚ù§Ô∏è","üíï","üíñ","üíó","üíò","üíù","üíì","üíû","‚ù£Ô∏è","üíü"];
      const spawn = () => {
        const h = document.createElement("div");
        h.className = "heart-rain";
        h.textContent = hearts[Math.floor(Math.random()*hearts.length)];
        h.style.left = Math.random()*100 + "%";
        h.style.fontSize = (Math.random()*22 + 20) + "px";
        h.style.animationDuration = (Math.random()*2.5 + 3.0) + "s";
        fxHeartRain.appendChild(h);
        setTimeout(() => h.remove(), 6500);
      };
      fxIntervals.push(setInterval(spawn, window.innerWidth < 520 ? 380 : 260));
    }

    function showCelebration(){
      state.yes = true;
      saveStateSafe();

      celebration.style.display = "flex";
      // Respect calm mode
      clearCelebrationFx();
      if (!state.reducedMotion){
        startFireworks();
        startConfetti();
        startCelebrationHeartRain();
      }
      vibrate(60);
    }

    // ---------- Playful ‚ÄúNo‚Äù logic ----------
    function playfulNo(buttonEl){
      state.noCount += 1;
      saveStateSafe();

      // Grow the "Yes" button with each "No" press
      const growFactor = 1 + state.noCount * YES_GROW_INCREMENT;
      const scale = Math.min(growFactor, YES_MAX_SCALE);
      finalYes.style.transform = "scale(" + scale + ")";
      finalYes.classList.remove("btn-pulse");
      void finalYes.offsetWidth; // reflow to restart animation
      finalYes.classList.add("btn-pulse");

      // Shrink the "No" button slightly
      const shrink = Math.max(1 - state.noCount * NO_SHRINK_DECREMENT, NO_MIN_SCALE);
      buttonEl.style.transform = "scale(" + shrink + ")";

      const msgIndex = clamp(state.noCount - 1, 0, NO_MESSAGES.length - 1);
      showModal(NO_MESSAGES[msgIndex]);
    }

    // ---------- Init content ----------
    function hydrateContent(){
      toLine.textContent = "To " + CONFIG.to;
      fromLine.textContent = "from " + CONFIG.from;

      herNameInline.textContent = CONFIG.to;
      herNameCelebr.textContent = CONFIG.to;

      if (CONFIG.photo){
        photoEl.src = CONFIG.photo;
        photoEl.classList.remove("hidden");
      }

      setDateLine();
    }

    // ---------- Start experience ----------
    function startExperience(withMusic){
      startOverlay.style.display = "none";
      app.classList.remove("hidden");

      hydrateContent();
      syncMotion();
      initBackground();
      startQuotes();

      // Restore last step / yes state
      if (state.yes){
        showCelebration();
      } else {
        showStep(state.step || 1);
      }

      // Music
      setMusic(!!withMusic);

      // Gentle, not spammy haptics
      document.querySelectorAll("button").forEach(b => {
        b.addEventListener("click", () => vibrate(18));
      });

      // Prevent iOS double-tap zoom
      let lastTouchEnd = 0;
      document.addEventListener("touchend", function(event){
        const now = Date.now();
        if (now - lastTouchEnd <= 300) event.preventDefault();
        lastTouchEnd = now;
      }, {passive:false});
    }

    // ---------- Wire events ----------
    beginBtn.addEventListener("click", () => startExperience(true));
    muteBtn.addEventListener("click", () => startExperience(false));

    s1Yes.addEventListener("click", () => showStep(2));
    s2Yes.addEventListener("click", () => showStep(3));

    // ‚ÄúNo‚Äù in step 1/2 still progresses, but playfully nudges
    // Brief delay for smooth step transition
    s1No.addEventListener("click", () => { setTimeout(() => showStep(2), 100); });
    s2No.addEventListener("click", () => { setTimeout(() => showStep(3), 100); });

    finalYes.addEventListener("click", () => showCelebration());
    finalNo.addEventListener("click", () => playfulNo(finalNo));

    // Keyboard support (desktop)
    document.addEventListener("keydown", (e) => {
      if (celebration.style.display === "flex") return;
      if (e.key === "Enter" || e.key === "y" || e.key === "Y"){
        if (state.step === 1) s1Yes.click();
        else if (state.step === 2) s2Yes.click();
        else if (state.step === 3) finalYes.click();
      }
    });


    // React to resize (recreate background for density)
    window.addEventListener("resize", () => {
      // Debounced-ish
      clearTimeout(window.__bgResizeTimer);
      window.__bgResizeTimer = setTimeout(() => initBackground(), 220);
    });

    // ---------- Boot ----------
    runLoader();

    // Console Easter egg
    console.log("%cüíñ Made with love.", "font-size:18px; font-weight:bold; color:#FF1493;");
  </script>
</body>
</html>
